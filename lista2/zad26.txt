SELECT K.FUNKCJA, AVG(PRZYDZIAL_MYSZY+NVL(MYSZY_EXTRA,0)) "Srednio najw. i najm. myszy"
FROM KOCURY K
WHERE FUNKCJA != 'SZEFUNIO' 
GROUP BY K.FUNKCJA
    HAVING AVG(PRZYDZIAL_MYSZY+NVL(MYSZY_EXTRA,0))-1 < 
        (SELECT MIN(AVG(PRZYDZIAL_MYSZY+NVL(MYSZY_EXTRA,0)))
        FROM KOCURY K1
        WHERE FUNKCJA !='SZEFUNIO'
        GROUP  BY K1.FUNKCJA)
    OR  AVG(PRZYDZIAL_MYSZY+NVL(MYSZY_EXTRA,0))+1 > 
        (SELECT MAX(AVG(PRZYDZIAL_MYSZY+NVL(MYSZY_EXTRA,0)))
        FROM KOCURY K2
        WHERE FUNKCJA !='SZEFUNIO'
        GROUP  BY K2.FUNKCJA);